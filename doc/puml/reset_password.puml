@startuml
'https://plantuml.com/sequence-diagram

title 修改密码逻辑
skinparam BoxPadding 40
autonumber "<font color=red><b>"
actor 用户 as User
activate User

User->User: 用户登录SSO
User -> Web: 点击修改密码按钮
    activate Web
    Web --> User: 返回修改密码弹窗
    deactivate Web
User -> Web: 输入两次新密码, 点击确定按钮
    activate Web
    Web -> Web: 校验两次密码是否一致
    Web -> Api: 获取公钥(参数，operate_id)
        activate Api
        Api -> Api: 生成密钥对
        Api -> Api: 保存密钥
        Api --> Web: 返回公钥
        deactivate Api
    Web -> Web: 使用公钥加密密码
    Web -> Api: 调用修改密码接口(参数, 加密的密码和operate_id)
        activate Api
        Api -> Api: 使用operate_id取得密钥
        Api -> Api: 解密密码
        Api -> Api: 校验密码格式
        Api -> Api: hash密码并更新密码, 同时更新修改时间
        Api --> Web: 返回密码更新成功
        deactivate Api
    Web --> User: 返回密码修改成功
@enduml